const express = require('express');
const fetch = require('node-fetch');
const app = express();

// ...existing code...

app.get('/api/leaderboard', async (req, res) => {
  const { start_date, end_date, code, site, type } = req.query;
  
  try {
    if (site === 'csgobig') {
      // CSGOBig API call - NIE wysyłaj parametru 'type'
      const csgobigParams = new URLSearchParams({
        start_date,
        end_date,
        code
        // NIE dodawaj 'type' dla CSGOBig!
      });
      
      const csgobigResponse = await fetch(`https://csgobig.com/api/leaderboard?${csgobigParams}`);
      const csgobigData = await csgobigResponse.json();
      
      return res.json(csgobigData);
    } else {
      // Rain.gg lub inne - WYSYŁAJ parametr 'type'
      const params = new URLSearchParams({
        start_date,
        end_date,
        code,
        type: type || 'wagered'
      });
      
      const response = await fetch(`https://rain.gg/api/leaderboard?${params}`);
      const data = await response.json();
      
      return res.json(data);
    }
  } catch (error) {
    console.error('Backend API error:', error);
    res.status(500).json({ error: error.message });
  }
});

// ...existing code...

module.exports = app;